CREATE DATABASE SubwayManagement
GO
USE SubwayManagement
GO


CREATE TABLE TRAIN_TYPES(
    TRAIN_TYPE_ID BIGINT NOT NULL,
    TRAIN_TYPE VARCHAR(255) NOT NULL,
    CONSTRAINT train_types_train_type_id_primary PRIMARY KEY(TRAIN_TYPE_ID)
)


CREATE TABLE TRAIN_DETAILS(
    TRAIN_ID BIGINT NOT NULL,
    TRAIN_NAME VARCHAR(255) NOT NULL,
    COACHES_NUM BIGINT NOT NULL,
    TRAIN_TYPE_ID BIGINT NOT NULL,
	CONSTRAINT train_details_train_id_primary PRIMARY KEY(TRAIN_ID),
	CONSTRAINT train_details_train_type_id_foreign FOREIGN KEY(TRAIN_TYPE_ID) REFERENCES TRAIN_TYPES(TRAIN_TYPE_ID)
)


CREATE TABLE PROVINCE_COUNTRY(
    PROVINCE VARCHAR(255) NOT NULL,
    COUNTRY VARCHAR(255) NOT NULL,
    CONSTRAINT province_country_province_primary PRIMARY KEY(PROVINCE)
)


CREATE TABLE STATIONS(
    STATION_ID BIGINT NOT NULL,
    STATION_STREET VARCHAR(255) NOT NULL,
    STATION_CITY VARCHAR(255) NOT NULL,
    PROVINCE VARCHAR(255) NOT NULL,
    POSTAL_CODE VARCHAR(255) NOT NULL,
    STATION_NAME VARCHAR(255) NOT NULL,
    CONSTRAINT stations_station_id_primary PRIMARY KEY(STATION_ID),
    CONSTRAINT stations_province_foreign FOREIGN KEY(PROVINCE) REFERENCES PROVINCE_COUNTRY(PROVINCE)
)


CREATE TABLE ROUTES(
    ROUTE_ID BIGINT NOT NULL,
    STATION_ID BIGINT NOT NULL,
    TRAIN_ID BIGINT NOT NULL,
    DEPARTURE_TIME TIME NOT NULL,
    ARRIVAL_TIME TIME NOT NULL,
    ROUTE_NAME VARCHAR(255) NOT NULL,
    CONSTRAINT routes_route_id_primary PRIMARY KEY(ROUTE_ID),
    CONSTRAINT routes_train_id_foreign FOREIGN KEY(TRAIN_ID) REFERENCES TRAIN_DETAILS(TRAIN_ID),
    CONSTRAINT routes_station_id_foreign FOREIGN KEY(STATION_ID) REFERENCES STATIONS(STATION_ID)
)


CREATE TABLE PASSENGERS(
    PASN_ID BIGINT NOT NULL,
    PASN_FNAME VARCHAR(255) NOT NULL,
    PASN_LNAME VARCHAR(255) NOT NULL,
    PASN_AGE BIGINT NOT NULL,
    PASN_PHONE_NUM BIGINT NOT NULL,
    PASN_EMAIL VARCHAR(255) NOT NULL,
    CONSTRAINT passengers_pasn_id_primary PRIMARY KEY(PASN_ID)
)


CREATE TABLE PASSES(
    PASS_ID BIGINT NOT NULL,
    TRAIN_ID BIGINT NOT NULL,
    PASS_ISSUED_DATE DATE NOT NULL,
    PASS_EXPIRE_DATE DATE NOT NULL,
    PRICE DECIMAL(8, 2) NOT NULL,
    PASN_ID BIGINT NOT NULL,
    ROUTE_ID BIGINT NOT NULL,
    CONSTRAINT pass_pass_id_primary PRIMARY KEY(PASS_ID),
    CONSTRAINT pass_route_id_foreign FOREIGN KEY(ROUTE_ID) REFERENCES ROUTES(ROUTE_ID),
    CONSTRAINT pass_train_id_foreign FOREIGN KEY(TRAIN_ID) REFERENCES TRAIN_DETAILS(TRAIN_ID),
    CONSTRAINT pass_pasn_id_foreign FOREIGN KEY(PASN_ID) REFERENCES PASSENGERS(PASN_ID)
)


CREATE TABLE ROUTES_STATIONS(
    ROUTE_ID BIGINT NOT NULL,
    STATION_ID BIGINT NOT NULL,
	CONSTRAINT routes_stations_station_id_foreign FOREIGN KEY(STATION_ID) REFERENCES STATIONS(STATION_ID),
	CONSTRAINT routes_stations_route_id_foreign FOREIGN KEY(ROUTE_ID) REFERENCES ROUTES(ROUTE_ID)
)

INSERT INTO TRAIN_TYPES (TRAIN_TYPE_ID, TRAIN_TYPE)
VALUES (1, 'Express'), (2, 'Local'), (3, 'Freight');

INSERT INTO TRAIN_DETAILS (TRAIN_ID, TRAIN_NAME, COACHES_NUM, TRAIN_TYPE_ID)
VALUES 
(1, 'Express Train 1', 10, 1),
(2, 'Local Train 1', 8, 2),
(3, 'Freight Train 1', 20, 3),
(4, 'Express Train 2', 12, 1),
(5, 'Local Train 2', 6, 2);

INSERT INTO PROVINCE_COUNTRY (PROVINCE, COUNTRY)
VALUES 
('Metro Province', 'Country A'),
('Rural Province', 'Country B'),
('Capitol Province', 'Country C');

INSERT INTO STATIONS (STATION_ID, STATION_STREET, STATION_CITY, PROVINCE, POSTAL_CODE, STATION_NAME)
VALUES 
(1, 'Main St', 'Metro City', 'Metro Province', 12345, 'Station 1'),
(2, 'Second St', 'Townsville', 'Metro Province', 54321, 'Station 2'),
(3, 'Third St', 'Village', 'Rural Province', 67890, 'Station 3'),
(4, 'Fourth St', 'Capitol City', 'Capitol Province', 98765, 'Station 4');


INSERT INTO ROUTES (ROUTE_ID, TRAIN_ID, STATION_ID, DEPARTURE_TIME, ARRIVAL_TIME, ROUTE_NAME)
VALUES 
(1, 1, 1, '08:00:00', '10:00:00', 'Route 1'),
(2, 2, 2, '09:00:00', '11:00:00', 'Route 2'),
(3, 3, 3, '07:00:00', '12:00:00', 'Route 3'),
(4, 4, 4, '10:00:00', '12:30:00', 'Route 4'),
(5, 5, 1, '11:00:00', '13:00:00', 'Route 5');

INSERT INTO ROUTES_STATIONS (ROUTE_ID, STATION_ID)
VALUES 
(1, 1), (1, 2), 
(2, 2), (2, 3), 
(3, 3), (3, 4),
(4, 1), (4, 4),
(5, 2), (5, 4);

INSERT INTO PASSENGERS (PASN_ID, PASN_FNAME, PASN_LNAME, PASN_AGE, PASN_PHONE_NUM, PASN_EMAIL)
VALUES 
(5, 'John', 'Doe', 30, 1234567890, 'john.doe@example.com'),
(6, 'Jane', 'Smith', 25, 2345678901, 'jane.smith@example.com'),
(7, 'Alice', 'Johnson', 28, 3456789012, 'alice.johnson@example.com'),
(8, 'Bob', 'Brown', 40, 4567890123, 'bob.brown@example.com');

INSERT INTO PASSES (PASS_ID, TRAIN_ID, PASS_ISSUED_DATE, PASS_EXPIRE_DATE, PRICE, PASN_ID, ROUTE_ID)
VALUES 
(9, 1, '2024-06-01', '2024-07-01', 50.00, 1, 1),
(10, 2, '2024-06-05', '2024-07-05', 40.00, 2, 2),
(11, 3, '2024-06-10', '2024-07-10', 60.00, 3, 3),
(12, 4, '2024-06-15', '2024-07-15', 55.00, 4, 4),
(13, 1, '2024-06-20', '2024-07-20', 50.00, 1, 1),
(14, 2, '2024-06-25', '2024-07-25', 40.00, 2, 2),
(15, 3, '2024-07-01', '2024-08-01', 60.00, 3, 3),
(16, 4, '2024-07-05', '2024-08-05', 55.00, 4, 4);
